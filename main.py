import numpy as np
import matplotlib.pyplot as plt

x = np.array([0, 0.0013, 0.0047, 0.0073, 0.0099, 0.0132, 0.0172, 0.0212, 0.0252, 0.0284, 0.0306, 0.0318, 0.0337, 0.0356, 0.037,
              0.0383, 0.0391, 0.0403, 0.0417, 0.0423, 0.0437, 0.0452, 0.0476, 0.0515, 0.0555, 0.0594, 0.0634, 0.0673, 0.0713,
              0.0753, 0.0792, 0.0832, 0.0871, 0.0911, 0.0951, 0.099, 0.103, 0.1069, 0.1109, 0.1149, 0.1188, 0.1228, 0.1267,
              0.1307, 0.1347, 0.1386, 0.1426, 0.1465, 0.1505, 0.1545, 0.1578, 0.1607, 0.1634, 0.1651, 0.1669, 0.1684, 0.17,
              0.1716, 0.173, 0.1739, 0.1749, 0.1759, 0.1762, 0.1775, 0.1789, 0.1799, 0.1809, 0.1828, 0.1838, 0.1855, 0.1877,
              0.1893, 0.1914, 0.194, 0.1973, 0.2013, 0.2053, 0.2092, 0.2132, 0.2168, 0.2201, 0.2232, 0.2257, 0.2274, 0.2291,
              0.231, 0.2329, 0.2343, 0.2356, 0.2369, 0.2383, 0.2396, 0.2409, 0.2419, 0.2435, 0.2445, 0.2461, 0.2475, 0.2488,
              0.2501, 0.2515, 0.2534, 0.2553, 0.2571, 0.259, 0.2608, 0.2629, 0.2647, 0.2672, 0.2689, 0.2719, 0.2736, 0.2765,
              0.2802, 0.2835, 0.2871, 0.291, 0.295, 0.299, 0.3029, 0.3069, 0.3108, 0.3148, 0.3184, 0.3217, 0.3252, 0.328,
              0.3306, 0.3333, 0.3362, 0.3382, 0.3402, 0.3422, 0.3442, 0.3458, 0.3472, 0.3492, 0.350, 0.350])

y = np.array([0, 0.7201, 1.7988, 2.5799, 3.2634, 4.0011, 4.5652, 4.8581, 4.5736, 3.8817, 3.1169, 2.4757, 1.6252, 0.7573, -0.0564,
              -0.9189, -1.879, -2.9747, -4.2028, -5.1011, -5.9343, -6.902, -7.694, -8.4425, -8.8873, -9.0392, -9.0284, -8.8548,
              -8.5402, -8.1605, -7.6506, -7.1732, -6.7067, -6.3596, -6.0558, -5.9039, -5.9582, -6.186, -6.5223, -6.8912, -7.2817,
              -7.618, -7.8567, -8.0411, -8.0954, -8.052, -7.8675, -7.5638, -7.0973, -6.4463, -5.7358, -5.01, -4.2223, -3.4868,
              -2.6406, -1.7423, -0.7236, 0.2908, 1.4191, 2.3521, 3.6539, 4.9124, 5.8671, 6.876, 7.9826, 8.9807, 9.9354, 10.9899,
              11.8231, 12.7214, 13.6736, 14.5245, 15.3544, 16.1518, 16.9003, 17.4319, 17.6815, 17.6272, 17.3235, 16.8353,
              16.0672, 15.1103, 14.1013, 13.3528, 12.5782, 11.7255, 10.7816, 9.9842, 9.2031, 8.3894, 7.6083, 6.7133, 5.8671,
              4.9623, 4.0282, 3.1874, 2.2414, 1.3594, 0.5783, -0.154, -1.0393, -1.9658, -2.9009, -3.7775, -4.7431, -5.5177,
              -6.3658, -7.1841, -7.9912, -8.7072, -9.56, -10.1458, -11.0029, -11.8317, -12.5347, -13.1835, -13.7042, -14.0622,
              -14.225, -14.149, -13.8236, -13.292, -12.5868, -11.7927, -10.9985, -10.1621, -9.202, -8.3557, -7.477, -6.6354,
              -5.7585, -5.0143, -4.2006, -3.3002, -2.5299, -1.7163, -0.8983, -0.0455, 0])

#INPUTS
grau_poli = 5


intervals = [0, 0.0425, 0.0992, 0.1609, 0.2593, 0.3500]

intervalx = [[] for _ in range(len(intervals) - 1)]
intervaly = [[] for _ in range(len(intervals) - 1)]

for i in range(len(x)):
    for j in range(len(intervals) - 1):
        if intervals[j] <= x[i] < intervals[j + 1]:
            intervalx[j].append(x[i])
            intervaly[j].append(y[i])
            break

for i in range(len(intervalx)):
    print(f"Intervalo {i+1} - Dados x: {intervalx[i]}, Dados y: {intervaly[i]}")

equations = []

for i in range(len(intervalx)):
    coeffs = np.polyfit(intervalx[i], intervaly[i], deg=grau_poli)
    equation = np.poly1d(coeffs)
    equations.append(equation)

for i in range(len(intervalx)):
    print(f"Intervalo {i+1} - Dados x: {intervalx[i]}, Dados y: {intervaly[i]}")
    print(f"Equação {i+1}: {equations[i]}")

coeffs = np.polyfit(x, y, grau_poli)
polynomial_fit = np.poly1d(coeffs)


plt.figure(1)
plt.plot(intervalx[0], intervaly[0], color = 'red', label = '1° parte')
plt.plot(intervalx[1], intervaly[1], color = 'green', label = '2° parte')
plt.plot(intervalx[2], intervaly[2], color = 'blue', label = '3° parte')
plt.plot(intervalx[3], intervaly[3], color = 'gray', label = '4° parte')
plt.plot(intervalx[4], intervaly[4], color = 'green', label = '5° parte')
plt.legend()
plt.figure(2)
plt.plot(x, y, color = 'blue', label = 'Função Original')
plt.show()